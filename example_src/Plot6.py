import matplotlib.pyplot as plt

#own Project
import src.FindBound as FindBound

Rav = [6.530152982184354, 8.9756184302733, 9.12996835443038, 14.223534912718204, 14.460574274471226, 67.51344319548524, 10.887315638906548, 18.141016228748068,\
    21.977748309932398, 5.629405594405594, 17.029811621966793, 14.524028322052011, 5.122608173076923, 11.446582524271845, 9.791972049689441, 39.22869718309859,\
    17.3958699963938, 48.5484089603676, 25.54122077922078, 17.610256315007433, 3.719775086505191, 2.5908161953727507, 4.551363636363636, 2.7216717171717173,\
    2.7896122448979592, 6.096315789473684, 3.7908891213389118, 22.81988708699606, 3.544212328767123, 1.7784561128526644, 2.5264035087719297, 7.763930423509075,\
    4.07287012987013, 4.023090659340659, 2.809463190184049, 4.79568848758465, 3.1920390781563133, 2.886165987780041, 3.3045109689213894, 1.8684636871508382,\
    2.486242268041237, 2.1194452449567724, 7.0726206757843935, 3.61, 27.50042931350581, 4.433127906976744, 4.112072230014026, 6.029727387996618,\
    12.85028871051269, 7.8198049391553335, 12.575430245854772, 5.984824016563147, 1.0834883720930233, 2.2032402597402596, 1.2079761904761903]

Mini = [2900726.652965129, 985382.097968107, 5061160.739889616, 6999984.078427373, 6692815.532333593, 4549828.273871388, 8270742.040663357, 376880.7939472952,\
    324228.45775088994, 5617773.431954882, 1117060.9930516623, 180485.3665015452, 17178544.707451876, 1095349.564164766, 3777491.301819135, 158944.06038240646,\
    717025.2346828709, 1124233.7646500466, 2418639.0459060213, 1419720.749091509, 12246880.684794972, 68594802.80422206, 15190343.348698383, 3589651.102332536,\
    3710883.319211324, 3046849.896662239, 894380.2496931624, 1552378.9270636134, 1541513.6997543804, 12533246.553588575, 5663240.366573315, 4714367.904201844,\
    907992.5379679025, 1064923.3066736867, 10045653.628348123, 685466.2186029609, 19460153.288935006, 12270417.761763547, 4510146.445993967, 6001179.638690045,\
    2185489.4043851807, 21498009.391438298, 1532345.3945039408, 6866324.988135637, 5509488.897409292, 1020398.0471844028, 1967709.8795838691, 319748.822303458,\
    2315441.2167807748, 1616489.374731162, 20804584.972937867, 1797798.9717446256, 256027221.96292552, 11906391.86542764, 218686980.69324952]

size = [28.24095682643737, 35.43215184370866, 26.703276549250845, 24.718518700873403, 26.033161606318355, 29.686712687669527, 23.68386322088223, 41.39454116666873,\
    44.40776649922545, 28.42681038852929, 37.062398497177796, 48.08254886783333, 21.94375844736407, 35.5090670114953, 29.834517816875696, 47.18452353966006,\
    39.1131443579749, 37.01937548352132, 33.38541741136045, 33.574903294578064, 22.81602682763333, 14.169584563172199, 20.59034026191543, 29.523268983738216,\
    27.536587463306173, 30.16939603207921, 36.18560068915717, 32.730135496733936, 34.01634867702917, 21.337115695750086, 27.49377096864366, 30.05535904775395,\
    35.429937237071904, 33.18658836794183, 20.707067938762446, 39.56179237100649, 19.16381174906353, 19.433453653697264, 29.363580491655295, 22.661897420826527,\
    30.17071195816068, 19.14208425863394, 34.98691167776712, 26.13663227304467, 27.552786962586595, 36.26039051012518, 33.76867465136695, 40.08285834766231,\
    30.724030237357624, 35.86184644453078, 19.484824740192984, 35.44239552851069, 5.644705905096403, 19.520753211564955, 9.514387088305975]

e = [0.15259488768396598, 0.7182901191310441, 0.8481012658227849, 0.9152119700748128, 0.9193310378750614, 0.7059857526135628, 0.8766687857596948, 0.49304482225656887,\
    0.5345813832553302, 0.7902097902097901, 0.41826309067688383, 0.2639828998931243, 0.6802884615384616, 0.47184466019417465, 0.8385093167701864, 0.7746478873239437,\
    0.7136675081139561, 0.8879954049396898, 0.45974025974025967, 0.7852897473997028, 0.7577854671280276, 0.8149100257069409, 0.8181818181818181, 0.44646464646464645,\
    0.5265306122448979, 0.6842105263157894, 0.33891213389121333, 0.8757199151257956, 0.3972602739726027, 0.4796238244514106, 0.46491228070175444, 0.8271391529818496,\
    0.34025974025974026, 0.4587912087912088, 0.5460122699386504, 0.4063205417607224, 0.74749498997996, 0.5926680244399185, 0.6453382084095065, 0.2960893854748603,\
    0.2247422680412372, 0.6657060518731989, 0.5253419147224457, 0.7058823529411765, 0.49073130983907115, 0.2488372093023256, 0.5539971949509117, 0.19695688926458157,\
    0.8135680994303469, 0.4889047959914101, 0.935963407661521, 0.6915113871635611, 0.7209302325581396, 0.5376623376623376, 0.746031746031746]


def PlotFig6():
    """creates Fig. 6 from Wirth et al. (2021)"""
    
    fig = plt.figure( figsize = [3.5,3.0], dpi = 200)
    plt.rcParams.update({'font.size': 8})
    
    plt.scatter( Rav, Mini, marker="o", c=e, cmap="RdYlBu", s = size )
    cbar = plt.colorbar()
    cbar.set_label( "$e$" )
    
    factor, exp = FindBound.FindBoundariesLog( Rav, Mini, False, False )
    plt.axline((1.0, factor*pow(1.0,exp)), (3.0,factor*pow(3.0,exp)), c="grey")
    
    factor, exp = FindBound.FindBoundariesLog( Rav, Mini, False, True )
    plt.axline((10.0, factor*pow(10.0,exp)), (30.0,factor*pow(30.0,exp)), c="grey", linestyle = "--")
    
    plt.xscale( "log" )
    plt.yscale( "log" )
    plt.ylim( [9e4,3.1e8] )
    
    plt.xlabel( "$R_{\\rm av} [\\rm kpc]$" )
    plt.ylabel( "$M_{\\rm ini} [M_\odot]$" )
    
    plt.annotate( "47 Tuc", ( 6.530152982184354,2900726.652965129 ), ( 55,10 ), textcoords = 'offset pixels', arrowprops = dict( arrowstyle = "->" ))
    
    plt.subplots_adjust(left=0.14, right=0.95, top=0.97, bottom=0.15)
    
    plt.show()
    plt.close()
